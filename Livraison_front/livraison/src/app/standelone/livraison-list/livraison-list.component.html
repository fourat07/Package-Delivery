<h2>ğŸ“¦ Liste des livraisons</h2>

<!-- ğŸ” Recherche et filtres -->
<div class="filters mb-3">
  <input 
  type="text" 
  placeholder="ğŸ” Rechercher (rÃ©fÃ©rence, client, statut...)" 
  [(ngModel)]="searchTerm" 
  (input)="applyFilters()" 
/>


  <label>De : <input type="date" [(ngModel)]="fromDate" (change)="applyFilters()" /></label>
  <label>Ã€ : <input type="date" [(ngModel)]="toDate" (change)="applyFilters()" /></label>

  <button (click)="toggleSortOrder()">
    Trier par date : {{ sortDirection === 'asc' ? 'â¬†ï¸ Croissant' : 'â¬‡ï¸ DÃ©croissant' }}
  </button>
</div>

<!-- ğŸ“· Scanner -->
<button *ngIf="currentUserRole === 'ROLE_ADMIN' "    (click)="toggleScanner()">ğŸ“· Scan</button>
<app-scanner *ngIf="showScanner"></app-scanner>

<button *ngIf="currentUserRole === 'ROLE_ADMIN'  " (click)="createTournee()" class="btn btn-primary mb-3">â• Nouvelle tournÃ©e</button>

<!-- ğŸ“‹ Tableau -->
<table class="table table-striped">
  <thead>
    <tr>
      <th>RÃ©fÃ©rence</th>
      <th>Nombre de colis</th>
      <th>Date de crÃ©ation</th>
      <th>Status</th>
      <th *ngIf="currentUserRole === 'ROLE_ADMIN'" >Client</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let l of paginatedLivraisons">
      <td>{{ l.reference }}</td>
      <td>{{ l.colisCount }}</td>
      <td>{{ l.dateCreation | date:'dd MMMM yyyy Ã  HH:mm' }}</td>
      <td> {{l.status}} </td>
      <td>{{ l.user || 'N/A' }}</td>
      <td>
        <button (click)="voirHistorique(l.id)" class="btn btn-info btn-sm">Voir historique</button>
        <button (click)="deleteLiv(l.id)" class="btn btn-danger btn-sm">ğŸ—‘ï¸</button>
      </td>
    </tr>
  </tbody>
</table>

<!-- Pagination -->
<div class="pagination mt-3">
  <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">â¬…ï¸ PrÃ©cÃ©dent</button>
  <span>Page {{ currentPage }} / {{ totalPages }}</span>
  <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">Suivant â¡ï¸</button>
</div>
